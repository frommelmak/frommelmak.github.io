<!DOCTYPE html>
<html lang="es">
<head>
          <title>frommelmak - Añadir discos en caliente a guest Debian 5.0 sobre ESXi&nbsp;host</title>
        <meta charset="utf-8" />




    <meta name="tags" content="esx" />
    <meta name="tags" content="vmware" />

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://frommelmak.com/">frommelmak <strong>Yet another Melmacian interested in technology...</strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="/">Home</a></li>
            <li><a href="https://frommelmak.com/pages/about.html">About</a></li>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="https://frommelmak.com/anadir-discos-en-caliente-a-guest-debian-50-sobre-esxi-host.html" rel="bookmark"
         title="Permalink to Añadir discos en caliente a guest Debian 5.0 sobre ESXi host">Añadir discos en caliente a guest Debian 5.0 sobre ESXi&nbsp;host</a></h2>
 
  </header>
  <footer class="post-info">
    <time class="published" datetime="2010-04-21T13:36:51+02:00">
      Wed 21 April 2010
    </time>
    <address class="vcard author">
      By           <a class="url fn" href="https://frommelmak.com/author/frommelmak.html">frommelmak</a>
    </address>
    <div class="category">
        Category: <a href="https://frommelmak.com/category/spanish.html">Spanish</a>
    </div>
    <div class="tags">
        Tags:
            <a href="https://frommelmak.com/tag/esx.html">esx</a>
            <a href="https://frommelmak.com/tag/vmware.html">vmware</a>
    </div>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>En primer lugar añadimos un nuevo disco al guest desde el host mediante&nbsp;vSphere.</p>
<p>El disco aun no se ve en el&nbsp;guest:</p>
<div class="highlight"><pre><span></span><span class="gp">guest666@root:#</span> cat /proc/scsi/scsi 
<span class="go">Attached devices: </span>
<span class="go">Host: scsi0 Channel: 00 Id: 01 Lun: 00 </span>
<span class="go"> Vendor: VMware Model: Virtual disk Rev: 1.0 </span>
<span class="go"> Type: Direct-Access ANSI SCSI revision: 02</span>
</pre></div>


<p>Por lo que un <code>sfdisk -l</code> no lo lista&nbsp;tampoco:</p>
<div class="highlight"><pre><span></span><span class="gp">guest666@root:#</span> sfdisk -l

<span class="go">Disk /dev/sda: 1305 cylinders, 255 heads, 63 sectors/track</span>
<span class="go">Units = cylinders of 8225280 bytes, blocks of 1024 bytes, counting from 0</span>

<span class="go"> Device Boot Start End #cyls #blocks Id System</span>
<span class="go">/dev/sda1 * 0+ 1178 1179- 9470286 83 Linux </span>
<span class="go">/dev/sda2 1179 1304 126 1012095 5 Extended</span>
<span class="go">/dev/sda3 0 - 0 0 0 Empty </span>
<span class="go">/dev/sda4 0 - 0 0 0 Empty </span>
<span class="go">/dev/sda5 1179+ 1304 126- 1012063+ 82 Linux swap / Solaris</span>
</pre></div>


<p>Lo que hay que hacer es forzar un re-scan de los dispositivos scsi. Para esto lo normal sería reiniciar, sin embargo podemos utilizar <code>scsiadd</code> en su lugar (<code>apt-get install scsiadd</code> si no lo&nbsp;tenemos).</p>
<div class="highlight"><pre><span></span><span class="gp">guest666@root:~#</span> scsiadd -s
<span class="go">Attached devices:</span>
<span class="go">Host: scsi0 Channel: 00 Id: 01 Lun: 00</span>
<span class="go"> Vendor: VMware Model: Virtual disk Rev: 1.0</span>
<span class="go"> Type: Direct-Access ANSI SCSI revision: 02</span>
<span class="go">Host: scsi0 Channel: 00 Id: 00 Lun: 00</span>
<span class="go"> Vendor: VMware Model: Virtual disk Rev: 1.0</span>
<span class="go"> Type: Direct-Access ANSI SCSI revision: 02</span>
</pre></div>


<p>Tras esto, el disco ya aparece en <code>/proc/scsi/scsi</code> y mediante <code>sfdisk -l</code>. Ahora ya sólo queda particionar y&nbsp;formatear.</p>
<p><em><span class="caps">IMPORTANTE</span>!!!</em> Tras trastear con <code>scsiadd</code>, es recomendable prestar especial atención al pórximo reeboot del sistema. En mi caso, no encontraba el disco de arranque <strong>operative system not found</strong>. Al parecer, tras reiniciar el identificador <span class="caps">SCSI</span>, del último disco añadido era el 0 en lugar del 2. Para solventarlo, hay que cambiar los <span class="caps">ID</span> <span class="caps">SCSI</span> desde vmware y habilitar la opción de entrar en la <span class="caps">BIOS</span> para conseguir arrancar el&nbsp;sistema.</p>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>