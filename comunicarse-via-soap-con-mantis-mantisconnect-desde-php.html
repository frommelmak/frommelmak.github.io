<!DOCTYPE html>
<html lang="es">
<head>
          <title>frommelmak - Comunicarse via <span class="caps">SOAP</span> con Mantis (Mantisconnect) desde <span class="caps">PHP</span></title>
        <meta charset="utf-8" />




    <meta name="tags" content="soap" />
    <meta name="tags" content="mantis" />
    <meta name="tags" content="php" />

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://frommelmak.com/">frommelmak <strong>Yet another Melmacian interested in technology...</strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="/">Home</a></li>
            <li><a href="https://frommelmak.com/pages/about.html">About</a></li>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="https://frommelmak.com/comunicarse-via-soap-con-mantis-mantisconnect-desde-php.html" rel="bookmark"
         title="Permalink to Comunicarse via SOAP con Mantis (Mantisconnect) desde PHP">Comunicarse via <span class="caps">SOAP</span> con Mantis (Mantisconnect) desde <span class="caps">PHP</span></a></h2>
 
  </header>
  <footer class="post-info">
    <time class="published" datetime="2008-11-26T22:15:54+01:00">
      Wed 26 November 2008
    </time>
    <address class="vcard author">
      By           <a class="url fn" href="https://frommelmak.com/author/frommelmak.html">frommelmak</a>
    </address>
    <div class="category">
        Category: <a href="https://frommelmak.com/category/spanish.html">Spanish</a>
    </div>
    <div class="tags">
        Tags:
            <a href="https://frommelmak.com/tag/soap.html">soap</a>
            <a href="https://frommelmak.com/tag/mantis.html">mantis</a>
            <a href="https://frommelmak.com/tag/php.html">php</a>
    </div>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>No he encontrado muchos ejemplos (por no decir ninguno) de como llamar a los mtodos <span class="caps">SOAP</span> de Mantis desde <span class="caps">PHP</span>, así que aquí dejo unos&nbsp;ejemplitos.</p>
<p>Lo primero de todo es saber que tras la instalación de Mantis, podemos obtener el <span class="caps">WSDL</span> bajo esta <span class="caps">URL</span>: <code>http://logquesea/api/soap/mantisconnect.php?wsdl</code></p>
<p>Adems del <span class="caps">WSDL</span>, es interesante saber que hay una ayuda para humanos acerca de los métodos disponibles. Se puede obtener omitiendo <code>?wsdl</code> en la llamada&nbsp;anterior.</p>
<p>A continuación os dejo los ejemplos sobre como llamar a algunos de estos métodos desde <span class="caps">PHP</span>.</p>
<p>Obtener la versin de&nbsp;Mantis:</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>

<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SoapClient</span><span class="p">(</span><span class="nx">http</span><span class="o">://</span><span class="nx">mantis</span><span class="o">/</span><span class="nx">api</span><span class="o">/</span><span class="nx">soap</span><span class="o">/</span><span class="nx">mantisconnect</span><span class="o">.</span><span class="nx">php</span><span class="o">?</span><span class="nx">wsdl</span><span class="p">);</span><span class="k">print</span><span class="p">(</span><span class="nv">$client</span><span class="o">-</span><span class="nx">mc_version</span><span class="p">());</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>


<p>Obtener array con diferentes estadisticas de&nbsp;Mantis</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>

<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SoapClient</span><span class="p">(</span><span class="nx">http</span><span class="o">://</span><span class="nx">mantis</span><span class="o">/</span><span class="nx">api</span><span class="o">/</span><span class="nx">soap</span><span class="o">/</span><span class="nx">mantisconnect</span><span class="o">.</span><span class="nx">php</span><span class="o">?</span><span class="nx">wsdl</span><span class="p">);</span><span class="nv">$username</span><span class="o">=</span><span class="nx">usuario</span><span class="p">;</span><span class="nv">$password</span><span class="o">=</span><span class="nx">contrasea</span><span class="p">;</span><span class="nb">print_r</span><span class="p">(</span><span class="nv">$client</span><span class="o">-</span><span class="nx">mc_enum_status</span><span class="p">(</span><span class="nv">$username</span><span class="p">,</span> <span class="nv">$password</span><span class="p">));</span>

<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>


<p>Aadir una nueva issue a&nbsp;Mantis</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>

<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SoapClient</span><span class="p">(</span><span class="nx">http</span><span class="o">://</span><span class="nx">mantis</span><span class="o">/</span><span class="nx">api</span><span class="o">/</span><span class="nx">soap</span><span class="o">/</span><span class="nx">mantisconnect</span><span class="o">.</span><span class="nx">php</span><span class="o">?</span><span class="nx">wsdl</span><span class="p">);</span>

<span class="nv">$username</span><span class="o">=</span><span class="nx">usuario</span><span class="p">;</span>
<span class="nv">$password</span><span class="o">=</span><span class="nx">constrasea</span><span class="p">;</span>

<span class="nv">$issue</span><span class="o">=</span><span class="k">array</span> <span class="p">(</span><span class="nx">project</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span><span class="nx">id</span> <span class="o">=</span> <span class="p">,</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">SOAP</span> <span class="nx">Test</span><span class="p">),</span>
              <span class="nx">category</span> <span class="o">=</span> <span class="nx">General</span><span class="p">,</span>
              <span class="nx">priority</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span><span class="nx">id</span> <span class="o">=</span> <span class="p">,</span> <span class="nx">name</span> <span class="o">=</span> <span class="p">),</span>
              <span class="nx">severity</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span><span class="nx">id</span> <span class="o">=</span> <span class="p">,</span> <span class="nx">name</span> <span class="o">=</span> <span class="p">),</span>
              <span class="nx">status</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span><span class="nx">id</span> <span class="o">=</span> <span class="p">,</span> <span class="nx">name</span> <span class="o">=</span> <span class="p">),</span>
              <span class="nx">reproducibility</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span><span class="nx">id</span> <span class="o">=</span> <span class="p">,</span> <span class="nx">name</span> <span class="o">=</span> <span class="p">),</span>
              <span class="nx">resolution</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span><span class="nx">id</span> <span class="o">=</span> <span class="p">,</span> <span class="nx">name</span> <span class="o">=</span> <span class="p">),</span>
              <span class="nx">projection</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span><span class="nx">id</span> <span class="o">=</span> <span class="p">,</span> <span class="nx">name</span> <span class="o">=</span> <span class="p">),</span>
              <span class="nx">eta</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span><span class="nx">id</span> <span class="o">=</span> <span class="p">,</span> <span class="nx">name</span> <span class="o">=</span> <span class="p">),</span>
              <span class="nx">view_state</span> <span class="o">=</span> <span class="k">array</span> <span class="p">(</span><span class="nx">id</span> <span class="o">=</span> <span class="p">,</span> <span class="nx">name</span> <span class="o">=</span> <span class="p">),</span>
              <span class="nx">summary</span>  <span class="o">=</span> <span class="nx">Test</span> <span class="nx">SOAP</span><span class="p">,</span>
              <span class="nx">description</span> <span class="o">=</span> <span class="k">This</span> <span class="nx">is</span> <span class="nx">just</span> <span class="nx">a</span> <span class="k">new</span> <span class="nx">issue</span> <span class="nx">added</span> <span class="nx">using</span> <span class="nx">SOAP</span><span class="p">);</span><span class="nv">$client</span><span class="o">-</span><span class="nx">mc_issue_add</span><span class="p">(</span><span class="nv">$username</span><span class="p">,</span> <span class="nv">$password</span><span class="p">,</span> <span class="nv">$issue</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>


<p><strong>Nota</strong>: Aquí lo importante es saber que los tipos de datos complejos del array (priority, severity, status, ) han de estar definidos pese a ser opcionales. De lo contrario el servidor soap da un error y no procesa la&nbsp;llamada.</p>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>