<!DOCTYPE html>
<html lang="es">
<head>
          <title>frommelmak - Grabando DVDs en FreeBSD&nbsp;5.3</title>
        <meta charset="utf-8" />




    <meta name="tags" content="freebsd" />
    <meta name="tags" content="dvd" />
    <meta name="tags" content="burn" />

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://frommelmak.com/">frommelmak <strong>Yet another Melmacian interested in technology...</strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="/">Home</a></li>
            <li><a href="https://frommelmak.com/pages/about.html">About</a></li>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="https://frommelmak.com/grabando-dvds-en-freebsd-53.html" rel="bookmark"
         title="Permalink to Grabando DVDs en FreeBSD 5.3">Grabando DVDs en FreeBSD&nbsp;5.3</a></h2>
 
  </header>
  <footer class="post-info">
    <time class="published" datetime="2006-02-02T23:13:12+01:00">
      Thu 02 February 2006
    </time>
    <address class="vcard author">
      By           <a class="url fn" href="https://frommelmak.com/author/frommelmak.html">frommelmak</a>
    </address>
    <div class="category">
        Category: <a href="https://frommelmak.com/category/spanish.html">Spanish</a>
    </div>
    <div class="tags">
        Tags:
            <a href="https://frommelmak.com/tag/freebsd.html">freebsd</a>
            <a href="https://frommelmak.com/tag/dvd.html">dvd</a>
            <a href="https://frommelmak.com/tag/burn.html">burn</a>
    </div>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>Hace tiempo que el backup de los ficheros sensibles de mi server no cabe en un único <span class="caps">CDROM</span>. El resultado práctico de esto es que el proceso automatico de backup requiere ahora de intervención humana, por lo que hace tiempo que no hago backups a soportes&nbsp;fisicos.</p>
<p>Hoy por fin, me he decidido a solventar el problema. Para ello he sustituido la actual unidad de CDs, por una de DVDs. Concretamente una regrabadora de DVDs/CDs 16x de <strong><span class="caps">LG</span> <span class="caps">GSA</span>-4167B</strong>.</p>
<p>A continuación explico como instalar una grabadora de DVDs/CDs en <strong>FreeBSD 5.3</strong> y como utilizar <code>growisofs</code> para quemar&nbsp;DVDs.</p>
<p>Grabando CDs en&nbsp;FreeBSD:</p>
<p>Actualmente, utilizaba un sencillo script que metia todos los datos sensibles del server (las webs básicamente) en en tarball, creaba la imagen mediante <code>mkisofs</code> y lo volcaba todo al <span class="caps">CD</span> mediante <code>burncd</code>.</p>
<p>Esta tool forma parte de la base del sistema FreeBSD, por lo que suele funcionar sin problemas si tienes las suerte de que tu grabadora este entre las soportadas. Si no lo está, simpre te queda la opción de tratar de acceder al dispositivo a traves del subsistema <span class="caps">SCSI</span>. Para ello, hemos de recompilar el kernel y ańadir soporte <span class="caps">ATAPI</span>/<span class="caps">CAM</span>.</p>
<p>Una vez hecho esto, deberiamos poder utilizar el programa <code>cdrecord</code> para para quemar nuestros&nbsp;CDs.</p>
<h2>Grabando DVDs en&nbsp;FreeBSD:</h2>
<p>Para trabajar con DVDs, utilizaremos <code>growisofs</code>.</p>
<p>Esta tool es en realidad un frontend a <code>mkisofs</code> pero además nos brinda la posibilidad de quemar directamente los DVDs. De esta manera, con <code>growisofs</code> podemos crear la imagen <span class="caps">ISO</span> y quemarla al <span class="caps">DVD</span> en un sólo&nbsp;paso. </p>
<p><code>growisofs</code> es parte del paquete <code>dvd+rw-tools</code>, y accede a la grabadora utilizando el subsistema <span class="caps">SCSI</span>. Así pues necesitaremos un kernel con soporte <span class="caps">ATAPI</span>/<span class="caps">CAM</span>.</p>
<p>En primer lugar, instalaremos las <code>dvd+rw-tools</code> en nuestros&nbsp;sistema:</p>
<div class="highlight"><pre><span></span><span class="go">cd /usr/ports/sysutils/dvd+rw-tools</span>
<span class="go">make install &amp;&amp; make clean</span>
</pre></div>


<p>Ahora necesitamos compilar un kernel con soporte <span class="caps">ATAPI</span>/<span class="caps">CAM</span>:</p>
<div class="highlight"><pre><span></span><span class="go">cd /usr/src/sys/i386/conf/</span>
<span class="go">cp GENERIC GENERIC_wtih_ATAPI_CAM</span>
</pre></div>


<p>Editamos el fichero <code>GENERIC_wtih_ATAPI_CAM</code> y ańadimos&nbsp;esto:</p>
<div class="highlight"><pre><span></span><span class="go">device          atapicam        # ATAPI/CAM Support using the SCSI subsystem</span>

<span class="go">config GENERIC_wtih_ATAPI_CAM</span>
<span class="go">cd ../compile/GENERIC_wtih_ATAPI_CAM/</span>
<span class="go">make depend</span>
<span class="go">make</span>
<span class="go">make install</span>
</pre></div>


<p>Ahora, tras rebotar deberiamos tener acceso a nuestra grabadora utilizando el subsistema <span class="caps">SCSI</span>:</p>
<p>Antes de rebotar vemos&nbsp;esto:</p>
<div class="highlight"><pre><span></span><span class="gp">root@patxi:~#</span> camcontrol devlist
<span class="go">QUANTUM ATLAS10K2-TY184L DA40    at scbus0 target 0 lun 0 (pass0,da0)</span>

<span class="gp">root@patxi:~#</span> cdrecord --scanbus
<span class="go">Cdrecord 2.00.3 (i386-unknown-freebsd5.3) Copyright (C) 1995-2002 Jg Schilling </span>
<span class="go">Using libscg version &#39;schily-0.7&#39;</span>
<span class="go">        0,0,0     0) &#39;QUANTUM &#39; &#39;ATLAS10K2-TY184L&#39; &#39;DA40&#39; Disk</span>
<span class="go">        0,1,0     1) *</span>
<span class="go">        0,2,0     2) *</span>
<span class="go">        0,3,0     3) *</span>
<span class="go">        0,4,0     4) *</span>
<span class="go">        0,5,0     5) *</span>
<span class="go">        0,6,0     6) *</span>
<span class="go">        0,7,0     7) *</span>
</pre></div>


<p>Si todo va bien, tras reiniciar el sistema deberiamos ver algo asi&nbsp;como:</p>
<div class="highlight"><pre><span></span><span class="gp">root@patxi:~#</span> cdrecord --scanbus
<span class="go">Cdrecord 2.00.3 (i386-unknown-freebsd5.3) Copyright (C) 1995-2002 Jg Schilling</span>
<span class="go">Using libscg version &#39;schily-0.7&#39;</span>
<span class="go">scsibus0:</span>
<span class="go">        0,0,0     0) &#39;QUANTUM &#39; &#39;ATLAS10K2-TY184L&#39; &#39;DA40&#39; Disk</span>
<span class="go">        0,1,0     1) *</span>
<span class="go">        0,2,0     2) *</span>
<span class="go">        0,3,0     3) *</span>
<span class="go">        0,4,0     4) *</span>
<span class="go">        0,5,0     5) *</span>
<span class="go">        0,6,0     6) *</span>
<span class="go">        0,7,0     7) *</span>
<span class="go">scsibus1:</span>
<span class="go">        1,0,0   100) &#39;HL-DT-ST&#39; &#39;CD-RW GCE-8400B &#39; &#39;1.02&#39; Removable CD-ROM</span>
<span class="go">        1,1,0   101) *</span>
<span class="go">        1,2,0   102) *</span>
<span class="go">        1,3,0   103) *</span>
<span class="go">        1,4,0   104) *</span>
<span class="go">        1,5,0   105) *</span>
<span class="go">        1,6,0   106) *</span>
<span class="go">        1,7,0   107) *</span>
</pre></div>


<p>Bien! Ya tenemos soporte. Ahora sólo hemos de pinchar la grabadora de DVDs y ver si el sistema también es capaz de&nbsp;detectarla.</p>
<div class="highlight"><pre><span></span><span class="gp">root@patxi:~#</span> cdrecord --scanbus
<span class="go">Cdrecord 2.00.3 (i386-unknown-freebsd5.3) Copyright (C) 1995-2002 Jg Schilling</span>
<span class="go">Using libscg version &#39;schily-0.7&#39;</span>
<span class="go">scsibus0:</span>
<span class="go">       0,0,0     0) &#39;QUANTUM &#39; &#39;ATLAS10K2-TY184L&#39; &#39;DA40&#39; Disk</span>
<span class="go">       0,1,0     1) *</span>
<span class="go">       0,2,0     2) *</span>
<span class="go">       0,3,0     3) *</span>
<span class="go">       0,4,0     4) *</span>
<span class="go">       0,5,0     5) *</span>
<span class="go">       0,6,0     6) *</span>
<span class="go">       0,7,0     7) *</span>
<span class="go">scsibus1:</span>
<span class="go">       1,0,0   100) &#39;HL-DT-ST&#39; &#39;CD-RW GCE-8400B &#39; &#39;1.02&#39; Removable CD-ROM</span>
<span class="go">       1,1,0   101) *</span>
<span class="go">       1,2,0   102) *</span>
<span class="go">       1,3,0   103) *</span>
<span class="go">       1,4,0   104) *</span>
<span class="go">       1,5,0   105) *</span>
<span class="go">       1,6,0   106) *</span>
<span class="go">       1,7,0   107) *</span>
</pre></div>


<p>Bueno, parece que vamos por el buen camino. A ver si además de verlo somos capaces de leer y/o grabar algo.
En primer lugar hemos de saber a traves de qué dispositivo accederemos a la unidad. Para ello, el comando camcontrol puede sernos de&nbsp;utilidad:</p>
<div class="highlight"><pre><span></span><span class="gp">root@patxi:~#</span> camcontrol devlist
<span class="go">QUANTUM ATLAS10K2-TY184L DA40    at scbus0 target 0 lun 0 (pass0,da0)</span>
<span class="go">HL-DT-ST DVDRAM GSA-4167B DL12   at scbus1 target 0 lun 0 (pass1,cd0)</span>
</pre></div>


<p>Ahora ya lo sabemos (<code>/dev/cd0</code>) introducimos un <span class="caps">DVD</span> en la unidad y utilizando el siguiente comando veremos si somos capaces de reconocer el <span class="caps">DVD</span> que hemos&nbsp;introducido:</p>
<div class="highlight"><pre><span></span><span class="gp">root@patxi:~#</span> dvd+rw-mediainfo /dev/cd0
<span class="go">INQUIRY:                [HL-DT-ST][DVDRAM GSA-4167B][DL12]</span>
<span class="go">GET [CURRENT] CONFIGURATION:</span>
<span class="go"> Mounted Media:         10h, DVD-ROM</span>
<span class="go"> Speed Descriptor#0:    02/404849 R@2.5x1385=3503KB/s W@6.1x1385=8467KB/s</span>
<span class="go"> Speed Descriptor#1:    02/404849 R@2.5x1385=3503KB/s W@5.1x1385=7056KB/s</span>
<span class="go"> Speed Descriptor#2:    02/404849 R@2.5x1385=3503KB/s W@4.1x1385=5645KB/s</span>
<span class="go"> Speed Descriptor#3:    02/404849 R@2.5x1385=3503KB/s W@3.1x1385=4234KB/s</span>
<span class="go"> Speed Descriptor#4:    02/404849 R@2.5x1385=3503KB/s W@2.0x1385=2822KB/s</span>
<span class="go"> Speed Descriptor#5:    02/404849 R@2.5x1385=3503KB/s W@1.0x1385=1411KB/s</span>
<span class="go"> Speed Descriptor#6:    02/404849 R@2.5x1385=3503KB/s W@0.5x1385=706KB/s</span>
<span class="go">READ DVD STRUCTURE[#0h]:</span>
<span class="go"> Media Book Type:       01h, DVD-ROM book [revision 1]</span>
<span class="go"> Legacy lead-out at:    2080080*2KB=4260003840</span>
<span class="go">READ DISC INFORMATION:</span>
<span class="go"> Disc status:           complete</span>
<span class="go"> Number of Sessions:    1</span>
<span class="go"> State of Last Session: complete</span>
<span class="go"> Number of Tracks:      1</span>
<span class="go">READ TRACK INFORMATION[#1]:</span>
<span class="go"> Track State:           complete</span>
<span class="go"> Track Start Address:   0*2KB</span>
<span class="go"> Free Blocks:           0*2KB</span>
<span class="go"> Track Size:            2080080*2KB</span>
<span class="go">FABRICATED TOC:</span>
<span class="go"> Track#1  :             14@0</span>
<span class="go"> Track#AA :             14@2080080</span>
<span class="go"> Multi-session Info:    #1@0</span>
<span class="go">READ CAPACITY:          2080080*2048=4260003840</span>
</pre></div>


<p>Vale, ahora metemos el primer <span class="caps">DVD</span> que tengamos a mano e intentaremos&nbsp;montarlo:</p>
<div class="highlight"><pre><span></span><span class="gp">root@patxi:~#</span> mount_cd9660 /dev/cd0 /mnt
<span class="gp">root@patxi:~#</span> ls /mnt
</pre></div>


<p>Bueno, la prueba final es tratar de grabar algo en un <span class="caps">DVD</span>:</p>
<div class="highlight"><pre><span></span><span class="gp">root@patxi:~#</span> growisofs -dvd-compat -Z /dev/cd0 -J -R /home/melmak/backup.tar
<span class="go">Executing &#39;/usr/local/bin/mkisofs -J -R /home/melmak/backup.tar | builtin_dd of=/dev/pass1 obs=32k seek=0&#39;</span>
<span class="go">/dev/pass1: &quot;Current Write Speed&quot; is 8.2x1385KBps.</span>
<span class="go">  1.13% done, estimate finish Thu Feb  2 23:32:49 2006</span>
<span class="go">  2.27% done, estimate finish Thu Feb  2 23:17:23 2006</span>
<span class="go">  3.40% done, estimate finish Thu Feb  2 23:12:15 2006</span>
<span class="go">  .</span>
<span class="go">  .</span>
<span class="go">  .</span>
<span class="go">  98.48% done, estimate finish Thu Feb  2 23:02:22 2006</span>
<span class="go">  99.62% done, estimate finish Thu Feb  2 23:02:21 2006</span>
<span class="go">Total translation table size: 0</span>
<span class="go">Total rockridge attributes bytes: 251</span>
<span class="go">Total directory bytes: 0</span>
<span class="go">Path table size(bytes): 10</span>
<span class="go">Max brk space used bac4</span>
<span class="go">441712 extents written (862 Mb)</span>
<span class="go">builtin_dd: 441712*2KB out @ average 6.5x1385KBps</span>
<span class="go">/dev/pass1: flushing cache</span>
<span class="go">/dev/pass1: updating RMA</span>
<span class="go">/dev/pass1: closing disc</span>
</pre></div>


<p>Ahora podemos montar el <span class="caps">DVD</span> para comprobar que los datos se han grabado&nbsp;correctamente.</p>
<p>En el caso de utilizar un <span class="caps">DVD</span> regrabable, antes de quemarlo deberemos formatearlo. Pata ello utilizaremos la herramienta&nbsp;dvd+rw-format:</p>
<div class="highlight"><pre><span></span><span class="go">dvd+rw-format -blank /dev/cd0</span>
</pre></div>


<p>Esto es todo. Os dejo unas fotos de todo el proceso <a href="http://nomeriasdeti.no-ip.com/index.php?top_tab=2&amp;section_type=3&amp;num=&amp;task=view&amp;id_album=24">aquí</a>.</p>
<p>Más info en el Freebsd&nbsp;Handbook:</p>
<p><a href="http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/creating-cds.html">Creating and Using Optical Media&nbsp;(CDs)</a></p>
<p><a href="http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/creating-dvds.html">Creating and Using Optical Media&nbsp;(DVDs)</a></p>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>