<!DOCTYPE html>
<html lang="es">
<head>
          <title>frommelmak - ESXi: Snapshots en otro&nbsp;datastore</title>
        <meta charset="utf-8" />




    <meta name="tags" content="vmware" />
    <meta name="tags" content="esxi" />
    <meta name="tags" content="virtualization" />

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://frommelmak.com/">frommelmak <strong>Yet another Melmacian interested in technology...</strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="/">Home</a></li>
            <li><a href="https://frommelmak.com/pages/about.html">About</a></li>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="https://frommelmak.com/esxi-snapshots-en-otro-datastore.html" rel="bookmark"
         title="Permalink to ESXi: Snapshots en otro datastore">ESXi: Snapshots en otro&nbsp;datastore</a></h2>
 
  </header>
  <footer class="post-info">
    <time class="published" datetime="2010-11-04T00:22:40+01:00">
      Thu 04 November 2010
    </time>
    <address class="vcard author">
      By           <a class="url fn" href="https://frommelmak.com/author/frommelmak.html">frommelmak</a>
    </address>
    <div class="category">
        Category: <a href="https://frommelmak.com/category/spanish.html">Spanish</a>
    </div>
    <div class="tags">
        Tags:
            <a href="https://frommelmak.com/tag/vmware.html">vmware</a>
            <a href="https://frommelmak.com/tag/esxi.html">esxi</a>
            <a href="https://frommelmak.com/tag/virtualization.html">virtualization</a>
    </div>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>Si al intentar hacer un snapshot de un guest nos dice que no tenemos espacio, tenemos dos opciones: La primera es añadir otro disco duro y añadirlo al datastore en el que reside la máquina, la segunda es hacer el snapshot en otro&nbsp;datastore.</p>
<p>No obstante, hay escenarios en los que la primera opción puede no ser una solución. Por ejemplo: Si el guest dispone de dos discos duros virtuales, cada uno en un datastore con tamano de bloque diferente, podría ser que pese a tener espacio, el tamaño máximo del fichero permitido en el datastore en el que reside el disco principal no permita realizar el snapshot. En este y otros casos, la solución pasa por forzar el snapshot en otro&nbsp;datastore.</p>
<p>Para ello, existe una variable que controla dónde se hacen los snapshots. Si esta variable no existe, se realizarán el el mismo folder dónde se encuentre el fichero <code>.vmx</code> que define la&nbsp;máquina.</p>
<p>Para hacer los snapshots en otro&nbsp;datastore:</p>
<ul>
<li>Paramos el&nbsp;guest.</li>
<li>Conectamos por ssh al host y editamos el `.vmx del guest a&nbsp;snapshotear.</li>
<li>Creamos un folder para los snapshots el el&nbsp;host</li>
<li>Añadimos la variable <code>workingDir=/vmfs/volumes/id-datastore/vm-snapshots</code></li>
<li>Desregistramos la máquina: <em>Remove from&nbsp;invetory</em></li>
<li>La volvemos a registrar utilizando el fichero <code>.vmx (ver captura)</code>.</li>
</ul>
<p><img alt="vmx register" src="|filename|/images/old_blog/register_vmachine.png"></p>
<p>Tras esto, veremos que el working dir es ahora otro el folder <code>vm-snapshots</code>. Este cambio afecta también al área de <em>swap</em> de esta máquina que pasa a estar en el nuevo&nbsp;datastore.</p>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>