<!DOCTYPE html>
<html lang="es">
<head>
          <title>frommelmak - Como mover un sistema <span class="caps">GNU</span>/Linux ya instalado a un <span class="caps">HDD</span>&nbsp;mayor</title>
        <meta charset="utf-8" />




    <meta name="tags" content="hdd" />
    <meta name="tags" content="dd" />

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://frommelmak.com/">frommelmak <strong>Yet another Melmacian interested in technology...</strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="/">Home</a></li>
            <li><a href="https://frommelmak.com/pages/about.html">About</a></li>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="https://frommelmak.com/como-mover-un-sistema-gnulinux-ya-instalado-a-un-hdd-mayor.html" rel="bookmark"
         title="Permalink to Como mover un sistema GNU/Linux ya instalado a un HDD mayor">Como mover un sistema <span class="caps">GNU</span>/Linux ya instalado a un <span class="caps">HDD</span>&nbsp;mayor</a></h2>
 
  </header>
  <footer class="post-info">
    <time class="published" datetime="2006-02-21T17:09:57+01:00">
      Tue 21 February 2006
    </time>
    <address class="vcard author">
      By           <a class="url fn" href="https://frommelmak.com/author/frommelmak.html">frommelmak</a>
    </address>
    <div class="category">
        Category: <a href="https://frommelmak.com/category/spanish.html">Spanish</a>
    </div>
    <div class="tags">
        Tags:
            <a href="https://frommelmak.com/tag/hdd.html">hdd</a>
            <a href="https://frommelmak.com/tag/dd.html">dd</a>
    </div>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>En ocasiones el Norton Ghost falla inesperadamente al intentar clonar un sistema <span class="caps">GNU</span>/Linux a un disco de mayor&nbsp;tamańo.</p>
<p>Cuando esto sucede, o bien cuando simplemente no queremos recurrir a soluciones propietarias, es posible utilizar el método descrito a&nbsp;continuación.</p>
<p><img alt="HDD" src="images/old_blog/harddisk.jpg"></p>
<p>Para seguir este método , es necesario utilizar una version Live de <span class="caps">GNU</span>/Linux. La más popular de ellas es Knoppix, la cual esta disponible tanto en imágenes para <span class="caps">CD</span>-<span class="caps">ROM</span> como para  <span class="caps">DVD</span>.</p>
<p>Puedes utilizar cualquier de los sitios que aparecen en este enlace para descargar la&nbsp;imagen:</p>
<p><a href="http://www.knopper.net/knoppix-mirrors/">http://www.knopper.net/knoppix-mirrors/</a></p>
<p>A grandes rasgos, el proceso que seguiremos es&nbsp;este:</p>
<ul>
<li>Pincharemos los dos discos en el sistema y lo arrancaremos con el Live-<span class="caps">CD</span>/<span class="caps">DVD</span></li>
<li>Volcaremos el contenido del primer disco en el&nbsp;segundo.</li>
<li>Recreamos la tabla de&nbsp;particiones</li>
<li>Expandimos el filesytem para ajustarse a la nueva&nbsp;particion</li>
<li>Recreamos el area de swap (en caso de que sea&nbsp;necesario)</li>
</ul>
<p>Prerequisitos</p>
<p>En este ejemplo, vamos a suponer que las particiones de datos de nuestro sistema utilizan el sistema de ficheros ext2/ext3 y discos duros <span class="caps">SCSI</span>.</p>
<p>Por otro lado, la partición que deseamos expandir, ha de ser la última con datos del disco duro. Si la última particiaon no tiene datos, como la de swap, entonces la podemos eliminar sin más, ya que la podemos volver a crear al final del disco duro sin&nbsp;problemas.</p>
<p>Todo esto, se basa en el hecho de que es posible eliminar una partición y volver a crearla sin perder los datos que contiene. Para ello, el único requisito es que la nueva partición empiece en el mismo punto que la anterior, haciendo que el final esté más lejos (aprovechando el espacio adicional del nuevo&nbsp;disco.)</p>
<p>Sigue los siguientes&nbsp;pasos:</p>
<ul>
<li>Conecta el nuevo disco duro al sistema. Quizás necesites modificar el identificador <span class="caps">SCSI</span> para evitar conflictos con el disco duro&nbsp;existente.</li>
<li>Arranca el sistema con el Live-<span class="caps">CD</span>/<span class="caps">DVD</span></li>
<li>Abre un terminal y conviertete en root ( con el comando <code>su</code> sin password en&nbsp;Knoppix)</li>
<li>Ahora necesitamos saber los ficheros de dispositivo asociados a cada disco duro (<code>/dev/sda</code> y <code>/dev/sdb</code> probablemente si son <span class="caps">SCSI</span>). Puedes utilizar el comando <code>sfdisk -s</code> para&nbsp;ello.</li>
<li>Suponiendo que tienes el disco viejo en <code>/dev/sda</code> y el nuevo en <code>/dev/sdb</code>, utiliza el commando <code>dd</code> para volcar el contenido del disco viejo en el&nbsp;nuevo:</li>
</ul>
<p>Ejemplo:</p>
<div class="highlight"><pre><span></span><span class="go">dd if=/dev/sda of=/dev/sdb</span>
</pre></div>


<p><strong>Truco</strong>: Comando <code>dd</code> en modo&nbsp;&#8220;verbose&#8221;</p>
<p>El comando <code>dd</code> no muestra información sobre el proceso de volcado hasta que ha finalizado. Dado que el proceso de volcado de un disco a otro puede llevar un tiempo considerable (del orden de horas a veces) sería muy interesante poder ver información relativa a la cantidad de datos&nbsp;volcados.</p>
<p>Para ello podemos recurrir a este <code>truco</code> que consiste en eviarle al proceso <code>dd</code> la seńal <code>USR1</code>.</p>
<p>Esto provoca que el comando <code>dd</code> saque por pantalla la cantidad de bytes transmitidos hasta el&nbsp;momento.</p>
<p>De esta manera, podermos ir viendo la progresión del&nbsp;volcado.</p>
<div class="highlight"><pre><span></span><span class="go">kill USR1 `ps -C dd -o pid=`</span>
</pre></div>


<ul>
<li>Cuando el comando <code>dd</code> finaliza, hemos de recrear la tabla de particiones del nuevo disco duro. Esto nos permitirá ampliar el filesystem de la partición primaria de nuestro nuevo&nbsp;sistema.</li>
</ul>
<p>Para reparticionar el disco duro nuevo, utilizaremos <code>fdisk</code>.</p>
<div class="highlight"><pre><span></span><span class="go">fisk /dev/sdb</span>
</pre></div>


<p>Utilizando los comandos que nos proporciona la consola de fdisk, es sumamente sencillo recrear la partición de&nbsp;root.</p>
<p>Supongamos que que disponemos de la partición de <code>/boot</code> (en <code>/dev/sdb1</code>) la raiz del sistema (en <code>/dev/sdb2</code>) y una partición de swap (en <code>/dev/sdb3</code>). En este caso el procedimiento seria&nbsp;este:</p>
<p>Eliminaremos las particiones de swap y la raiz del sistema (<code>/dev/sdb3</code> y <code>/dev/sdb2</code>) utilizando para ello la opción <code>d</code> de la consola de <code>fdisk</code>.</p>
<p>Luego recrearemos la partición de root (opciones <code>n</code> y <code>p</code> de la consola de <code>fdisk</code>), teniendo especial precaución en que el inicio de la misma sea el mismo que antes de borrarla (<span class="caps">INTRO</span> opcion por defecto). El tamańo de la misma dependerá del tamańo de nuestro disco duro, teniendo en cuenta que hemos de dejar espacio suficiente al final para el área de&nbsp;swap.</p>
<p>Finalmente, recreamos la partición de swap (que puede empezar a continuación de la partición de&nbsp;root).</p>
<p>Recuerda cambiar el tipo de partición para idendificar esta partición como area de swap (utiliza el comando <code>t</code> de <code>fdisk</code> y el tipo 82 para&nbsp;ello).</p>
<p>Abandona la consola de <code>fdisk</code> utilizando la opción <code>w</code> para que los cambios que has realizado tengan&nbsp;efecto.</p>
<p>Ahora llega el momento de expander el filesystem de la partición raiz para que se ajueste al tamańo de la nueva&nbsp;partición.</p>
<div class="highlight"><pre><span></span><span class="go">resize2fs p /dev/sdb2</span>
</pre></div>


<p>Finalmente, creamos y activamos el nuevo area de&nbsp;swap</p>
<div class="highlight"><pre><span></span><span class="go">mkswap /dev/sdb3</span>
<span class="go">swapon /dev/sdb3</span>
</pre></div>


<p>Esto es todo. Reinicia el sistema con el nuevo disco&nbsp;duro.</p>
<p>Una vez arancado, puedes chequear el espacio disponible en la nueva partición raiz con el&nbsp;comando:</p>
<div class="highlight"><pre><span></span><span class="go">df -h</span>
</pre></div>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>